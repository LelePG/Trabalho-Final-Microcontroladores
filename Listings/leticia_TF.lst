C51 COMPILER V9.60.0.0   LETICIA_TF                                                        11/10/2021 06:49:35 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE LETICIA_TF
OBJECT MODULE PLACED IN .\Objects\leticia_TF.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE leticia_TF.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listing
                    -s\leticia_TF.lst) TABS(2) OBJECT(.\Objects\leticia_TF.obj)

line level    source

   1          #include <at89x52.h>
   2          #include <lib_timers.h>
   3          #include <lib_7seg.h>
   4          #include <lib_keypad.h>
   5          #include <lib_lcd.h>
   6          #include <definesIO.h>
   7          
   8          
   9          void ativaAgua(void);
  10          void verificaSegundo(); //Verifica se um segundo se passou
  11          int defineIntervalo();
  12          void configuraAplicacao();
  13          void ligaLED(int tempoDelay);
  14          
  15          int valorResetaTimer = 200;
  16          int contadorDeMiliSeg;
  17          int segundosDisplay;
  18          
  19          void main()
  20          {
  21   1        configLCD();
  22   1        configuraAplicacao();
  23   1        while (1)
  24   1        {
  25   2      
  26   2          atualizaDisplays(segundosDisplay);
  27   2          if(segundosDisplay == 0){
  28   3            ativaAgua();
  29   3          }
  30   2          //delayT0(1000);
  31   2        }
  32   1      }
  33          
  34          int c = 0;
  35          
  36          void ligaLED(int tempoDelay)
  37          { //Prot�tipo tem coisa pra melhorar aqui
  38   1        enableAllLEDs = 0;
  39   1        enableLEDs = 1;
  40   1        for (c = 0; c <= 10; c++)
  41   1        {
  42   2          decodificaAlgorismo(c);
  43   2          delayT0(tempoDelay * 0.5);
  44   2        }
  45   1        enableAllLEDs = 1;
  46   1        delayT0(tempoDelay * 2);
  47   1        enableAllLEDs = 0;
  48   1        enableLEDs = 0;
  49   1        return;
  50   1      }
  51          
  52          void configuraAplicacao() interrupt 0
  53          {
  54   1        enableAllLEDs = 0;
C51 COMPILER V9.60.0.0   LETICIA_TF                                                        11/10/2021 06:49:35 PAGE 2   

  55   1        enableLEDs = 0;
  56   1        defineIntervalo();
  57   1      
  58   1        EA = 1;
  59   1        ET1 = 1;
  60   1        EX0 = 1;
  61   1        EX1 = 1;
  62   1        segundosDisplay = valorResetaTimer;
  63   1        iniciaCont50msT1();
  64   1      }
  65          
  66          int defineIntervalo()
  67          {
  68   1      
  69   1        int inputUsuario;
  70   1        int tempoFinal = 0;
  71   1          mensagemInicial();
  72   1      
  73   1        do
  74   1        {
  75   2          tempoFinal *= 10;
  76   2          tempoFinal += inputUsuario;
  77   2          inputUsuario = identificaCaractere();
  78   2          //atualizaDisplays(inputUsuario);
  79   2          delayT0(300);
  80   2        } while (inputUsuario >= 0);
  81   1        valorResetaTimer = tempoFinal;
  82   1        
  83   1        clearLCD();
  84   1        return tempoFinal;
  85   1      }
  86          
  87          
  88          
  89          void ativaAgua(void) interrupt 2//não está retornando pra main
  90          { // foi apertardo o bot�o p3.2
  91   1        //reseta o contador principal
  92   1        mensagemAguaInicial();
  93   1        
  94   1        EA = 0;
  95   1        unidade = 1;
  96   1        dezena = 1;
  97   1        centena = 1;
  98   1        milhar = 1;
  99   1        desativaT1();
 100   1        contadorDeMiliSeg = 0;
 101   1        segundosDisplay = valorResetaTimer;
 102   1      
 103   1        //Ativa luz, buzzer e bomba
 104   1        ligaLED(500);
 105   1      
 106   1        EA = 1;
 107   1        iniciaCont50msT1();
 108   1        
 109   1        mensagemAguaFinal();
 110   1        return;
 111   1      }
 112          
 113          
 114          
 115          void verificaSegundo() interrupt 3
 116          {
C51 COMPILER V9.60.0.0   LETICIA_TF                                                        11/10/2021 06:49:35 PAGE 3   

 117   1        //Verifica se um segundo passou, levando em considera��o que para que isso aconte�a
 118   1        //a fun��o espera 50ms precisa ser executada 200 vezes.
 119   1        desativaT1();
 120   1        contadorDeMiliSeg++; //anota mais uma execu��o da fun��o espera 50ms
 121   1        if (contadorDeMiliSeg == 200)
 122   1        {
 123   2          segundosDisplay--; //diminui o valor de segundos exibido no display
 124   2          contadorDeMiliSeg = 0;
 125   2        }
 126   1        iniciaCont50msT1(); // inicia o contador novamente
 127   1        return;
 128   1      }
 129          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    992    ----
   CONSTANT SIZE    =     67    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8      12
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
