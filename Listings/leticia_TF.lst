C51 COMPILER V9.60.0.0   LETICIA_TF                                                        11/10/2021 05:42:42 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE LETICIA_TF
OBJECT MODULE PLACED IN .\Objects\leticia_TF.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE leticia_TF.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listing
                    -s\leticia_TF.lst) TABS(2) OBJECT(.\Objects\leticia_TF.obj)

line level    source

   1          #include <at89x52.h>
   2          #include <lib_timers.h>
   3          #include <lib_7seg.h>
   4          #include <lib_keypad.h>
   5          #include <definesIO.h>
   6          
   7          
   8          void ativaAgua(void);
   9          void verificaSegundo(); //Verifica se um segundo se passou
  10          int defineIntervalo();
  11          void configuraAplicacao();
  12          void ligaLED(int tempoDelay);
  13          
  14          int valorResetaTimer = 200;
  15          int contadorDeMiliSeg;
  16          int segundosDisplay;
  17          
  18          void main()
  19          {
  20   1        configuraAplicacao();
  21   1        while (1)
  22   1        {
  23   2      
  24   2          atualizaDisplays(segundosDisplay);
  25   2          if(segundosDisplay == 0){
  26   3            ativaAgua();
  27   3          }
  28   2          //delayT0(1000);
  29   2        }
  30   1      }
  31          
  32          int c = 0;
  33          
  34          void ligaLED(int tempoDelay)
  35          { //Prot�tipo tem coisa pra melhorar aqui
  36   1        enableAllLEDs = 0;
  37   1        enableLEDs = 1;
  38   1        for (c = 0; c <= 10; c++)
  39   1        {
  40   2          decodificaAlgorismo(c);
  41   2          delayT0(tempoDelay * 0.5);
  42   2        }
  43   1        enableAllLEDs = 1;
  44   1        delayT0(tempoDelay * 2);
  45   1        enableAllLEDs = 0;
  46   1        enableLEDs = 0;
  47   1        return;
  48   1      }
  49          
  50          void configuraAplicacao() interrupt 0
  51          {
  52   1        enableAllLEDs = 0;
  53   1        enableLEDs = 0;
  54   1        defineIntervalo();
C51 COMPILER V9.60.0.0   LETICIA_TF                                                        11/10/2021 05:42:42 PAGE 2   

  55   1      
  56   1        EA = 1;
  57   1        ET1 = 1;
  58   1        EX0 = 1;
  59   1        EX1 = 1;
  60   1        segundosDisplay = valorResetaTimer;
  61   1        iniciaCont50msT1();
  62   1      }
  63          
  64          int defineIntervalo()
  65          {
  66   1        int inputUsuario;
  67   1        int tempoFinal = 0;
  68   1        do
  69   1        {
  70   2          tempoFinal *= 10;
  71   2          tempoFinal += inputUsuario;
  72   2          inputUsuario = identificaCaractere();
  73   2          //atualizaDisplays(inputUsuario);
  74   2          delayT0(300);
  75   2        } while (inputUsuario >= 0);
  76   1        valorResetaTimer = tempoFinal;
  77   1        return tempoFinal;
  78   1      }
  79          
  80          
  81          
  82          void ativaAgua(void) interrupt 2//não está retornando pra main
  83          { // foi apertardo o bot�o p3.2
  84   1        //reseta o contador principal
  85   1        EA = 0;
  86   1        unidade = 1;
  87   1        dezena = 1;
  88   1        centena = 1;
  89   1        milhar = 1;
  90   1        desativaT1();
  91   1        contadorDeMiliSeg = 0;
  92   1        segundosDisplay = valorResetaTimer;
  93   1      
  94   1        //Ativa luz, buzzer e bomba
  95   1        ligaLED(500);
  96   1      
  97   1        EA = 1;
  98   1        iniciaCont50msT1();
  99   1        return;
 100   1      }
 101          
 102          
 103          
 104          void verificaSegundo() interrupt 3
 105          {
 106   1        //Verifica se um segundo passou, levando em considera��o que para que isso aconte�a
 107   1        //a fun��o espera 50ms precisa ser executada 200 vezes.
 108   1        desativaT1();
 109   1        contadorDeMiliSeg++; //anota mais uma execu��o da fun��o espera 50ms
 110   1        if (contadorDeMiliSeg == 200)
 111   1        {
 112   2          segundosDisplay--; //diminui o valor de segundos exibido no display
 113   2          contadorDeMiliSeg = 0;
 114   2        }
 115   1        iniciaCont50msT1(); // inicia o contador novamente
 116   1        return;
C51 COMPILER V9.60.0.0   LETICIA_TF                                                        11/10/2021 05:42:42 PAGE 3   

 117   1      }
 118          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    790    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
